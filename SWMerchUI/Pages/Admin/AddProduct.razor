@page "/Admin/AddProduct"
@using SWMerchDataRepository.Models
@using SWMerchDataRepository.Contracts
@using SWMerchUI.DisplayModels

@inject IRepositoryWrapper _repo

<h3>Add a New Product</h3>

<EditForm Model="@product" OnValidSubmit="@InsertProduct">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <InputText id="productName" @bind-Value="product.ProductName" />
    <InputNumber id="price" @bind-Value="product.Price" />
    <InputText id="imgUrl" @bind-Value="product.ImgUrl" />
    <InputText id="shortDesc" @bind-Value="product.ShortDesc" />
    <InputText id="longDesc" @bind-Value="product.LongDesc" />
    <InputNumber id="moralityPoints" @bind-Value="product.MoralityPoints" />

    <button type="submit" class="btn btn-info">Submit</button>
</EditForm>

@code {
    private DisplayProduct product = new DisplayProduct();

    private void InsertProduct()
    {
        Product productToAdd = new Product
        {
            ProductName = product.ProductName,
            Price = product.Price,
            ImgUrl = product.ImgUrl,
            ShortDesc = product.ShortDesc,
            LongDesc = product.LongDesc,
            MoralityPoints = product.MoralityPoints
        };

        _repo.Product.InsertProduct(productToAdd);
        _repo.Save();
    }
}
